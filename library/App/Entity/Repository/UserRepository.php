<?php

namespace App\Entity\Repository;

use Doctrine\ORM\EntityRepository,
	App\Entity\User;

/**
 * UserRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class UserRepository extends EntityRepository
{
	/**
	 * Save a new user in the db. Used in the client area.
	 * @param User $user The new user entity
	 * @param array $values Values submitted by the user
	 */
	public function register(User $user, array $values)
    {
		$user->setUsername($values['username']);
		
		if($values['password'])
		{
			$user->setPassword($values['password']);
		}

        $this->getEntityManager()->persist($user);
    }
	
	/**
	 * Update a user in the db. Used in the admin area.
	 * @param User $user The existing user entity
	 * @param array $values Values submitted by the user
	 */
	public function save(User $user, array $values)
    {
		$user->setUsername($values['username']);
		// set other values which shouldn't be set when registering
		
		if($values['password'])
		{
			$user->setPassword($values['password']);
		}

        $this->getEntityManager()->persist($user);
    }
	
	public function removeUser($id)
    {
        $em    = $this->getEntityManager();
        $proxy = $em->getReference('\App\Entity\User', $id);

        $em->remove($proxy);
    }
}